# Homework Question - 02

## Date : 21/01/26

### 1. Create the following table, and mention the required datatypes, constraints as per your understanding. Make sure to include all 5 datatypes and all 5 constraints discussed in the class.

```sql
MariaDB [iilm]> CREATE TABLE Movie(
    -> MovieID INT PRIMARY KEY,
    -> MovieName VARCHAR(20) UNIQUE,
    -> Category CHAR(15) NOT NULL,
    -> ReleaseDate DATE DEFAULT NULL,
    -> ProductionCost FLOAT(10,2) NOT NULL,
    -> BusinessCost INT,
    -> FOREIGN KEY (BusinessCost) REFERENCES Department(BusinessCost));
Query OK, 0 rows affected (0.031 sec)
```

```sql
MariaDB [iilm]> DESC MOVIE;
```

<pre>
+----------------+-------------+------+-----+---------+-------+
| Field          | Type        | Null | Key | Default | Extra |
+----------------+-------------+------+-----+---------+-------+
| MovieID        | int(11)     | NO   | PRI | NULL    |       |
| MovieName      | varchar(20) | YES  | UNI | NULL    |       |
| Category       | char(15)    | NO   |     | NULL    |       |
| ReleaseDate    | date        | YES  |     | NULL    |       |
| ProductionCost | float(10,2) | NO   |     | NULL    |       |
| BusinessCost   | int(11)     | YES  | MUL | NULL    |       |
+----------------+-------------+------+-----+---------+-------+
6 rows in set (0.031 sec)
</pre>

### 2. As per the visible results, input the values inside the table.

```sql
MariaDB [iilm]> INSERT INTO Movie
    -> (MovieID, MovieName, Category, ReleaseDate, ProductionCost, BusinessCost)
    -> VALUES
    -> (1, 'Hindi_Movie', 'Musical', '2018-04-23', 124500, 130000),
    -> (2, 'Tamil_Movie', 'Action', '2016-05-17', 112000, 118000),
    -> (3, 'English_Movie', 'Horror', '2017-08-06', 245000, 360000),
    -> (4, 'Bengali_Movie', 'Adventure', '2017-01-04', 72000, 100000),
    -> (5, 'Telugu_Movie', 'Action', NULL, 100000, NULL),
    -> (6, 'Punjabi_Movie', 'Comedy', NULL, 30500, NULL);
Query OK, 6 rows affected (0.007 sec)
Records: 6  Duplicates: 0  Warnings: 0
```

### 3. Write the query to display the results of the above table:

```sql
MariaDB [iilm]> select *from movie;
```

<pre>
+---------+---------------+-----------+-------------+----------------+--------------+
| MovieID | MovieName     | Category  | ReleaseDate | ProductionCost | BusinessCost |
+---------+---------------+-----------+-------------+----------------+--------------+
|       1 | Hindi_Movie   | Musical   | 2018-04-23  |      124500.00 |       130000 |
|       2 | Tamil_Movie   | Action    | 2016-05-17  |      112000.00 |       118000 |
|       3 | English_Movie | Horror    | 2017-08-06  |      245000.00 |       360000 |
|       4 | Bengali_Movie | Adventure | 2017-01-04  |       72000.00 |       100000 |
|       5 | Telugu_Movie  | Action    | NULL        |      100000.00 |         NULL |
|       6 | Punjabi_Movie | Comedy    | NULL        |       30500.00 |         NULL |
+---------+---------------+-----------+-------------+----------------+--------------+
6 rows in set (0.001 sec)
</pre>

#### a. List business done by the movies showing only MovieID, MovieName and BusinessCost.

```sql
SELECT MovieID, Moviename, BusinessCost FROM Movie;
```

<pre>
+---------+---------------+--------------+
| MovieID | Moviename     | BusinessCost |
+---------+---------------+--------------+
|       1 | Hindi_Movie   |       130000 |
|       2 | Tamil_Movie   |       118000 |
|       3 | English_Movie |       360000 |
|       4 | Bengali_Movie |       100000 |
|       5 | Telugu_Movie  |         NULL |
|       6 | Punjabi_Movie |         NULL |
+---------+---------------+--------------+
6 rows in set (0.083 sec)
</pre>

#### b. List the different categories of movies. (USE THE DISTINCT KEYWORD).

```sql
 SELECT DISTINCT Category FROM Movie;
```

<pre>
+-----------+
| Category  |
+-----------+
| Musical   |
| Action    |
| Horror    |
| Adventure |
| Comedy    |
+-----------+
5 rows in set (0.001 sec)
</pre>

#### c. Find the net profit of each movie showing its ID, Name and Net Profit.

(Hint: Net Profit = BusinessCost â€“ ProductionCost)
Make sure that the new column name is labelled as NetProfit. Is this column now a part of the MOVIE relation. If no, then what name is coined for such columns? What can you say about the profit of a movie which has not yet released? Does your query result show profit as zero?

```sql
 SELECT MovieID, MovieName, (BusinessCost-ProductionCost) AS NetProfit FROM Movie;
```

<pre>
+---------+---------------+-----------+
| MovieID | MovieName     | NetProfit |
+---------+---------------+-----------+
|       1 | Hindi_Movie   |   5500.00 |
|       2 | Tamil_Movie   |   6000.00 |
|       3 | English_Movie | 115000.00 |
|       4 | Bengali_Movie |  28000.00 |
|       5 | Telugu_Movie  |      NULL |
|       6 | Punjabi_Movie |      NULL |
+---------+---------------+-----------+
6 rows in set (0.001 sec)
</pre>

#### d. List all movies with ProductionCost greater than 80,000 and less than 1,25,000 showing ID, Name and ProductionCost.

```sql
SELECT MovieID, MovieName, ProductionCost FROM Movie WHERE ProductionCost > 80000 AND ProductionCost < 125000;
```

<pre>
+---------+--------------+----------------+
| MovieID | MovieName    | ProductionCost |
+---------+--------------+----------------+
|       1 | Hindi_Movie  |      124500.00 |
|       2 | Tamil_Movie  |      112000.00 |
|       5 | Telugu_Movie |      100000.00 |
+---------+--------------+----------------+
3 rows in set (0.001 sec)
</pre>

#### e. List all movies which fall in the category of Comedy or Action.

```sql
SELECT *FROM Movie WHERE Category IN ('Action', 'Comedy');
```

<pre>
+---------+---------------+----------+-------------+----------------+--------------+
| MovieID | MovieName     | Category | ReleaseDate | ProductionCost | BusinessCost |
+---------+---------------+----------+-------------+----------------+--------------+
|       2 | Tamil_Movie   | Action   | 2016-05-17  |      112000.00 |       118000 |
|       5 | Telugu_Movie  | Action   | NULL        |      100000.00 |         NULL |
|       6 | Punjabi_Movie | Comedy   | NULL        |       30500.00 |         NULL |
+---------+---------------+----------+-------------+----------------+--------------+
3 rows in set (0.001 sec)
</pre>

#### f. List the movies which have not been released yet.

```sql
SELECT *FROM Movie WHERE ReleaseDate IS NULL;
```

<pre>
+---------+---------------+----------+-------------+----------------+--------------+
| MovieID | MovieName     | Category | ReleaseDate | ProductionCost | BusinessCost |
+---------+---------------+----------+-------------+----------------+--------------+
|       5 | Telugu_Movie  | Action   | NULL        |      100000.00 |         NULL |
|       6 | Punjabi_Movie | Comedy   | NULL        |       30500.00 |         NULL |
+---------+---------------+----------+-------------+----------------+--------------+
2 rows in set (0.001 sec)
</pre>
